

# “赛博牛顿 (Cyber Newton)”开发报告
**——基于 Gemini 与 MemOS 的个性化数学助教系统**

## 1. 要解决什么学习问题 (Problem Statement)

在工科数学（如微积分、线性代数）的学习过程中，学生常面临以下痛点，这些问题是通用大模型（如 ChatGPT 网页版）难以完全解决的：

1.  **缺乏个性化与连贯性**：通用 AI 无法记住用户的长期学习进度、薄弱环节或个人偏好。每次对话都是“初次见面”，缺乏“导师”的连贯感。
2.  **公式输入与交互困难**：在移动端（手机/平板）输入复杂的数学公式（如 $\int$, $\sum$, $\partial$）非常繁琐，导致随时随地提问变得困难。
3.  **缺乏沉浸感与趣味性**：枯燥的数学解答难以维持学习动力。学生需要一个更具人格魅力、甚至带有“严厉”风格的角色来激发挑战欲。
4.  **数据隐私与本地化**：希望聊天记录和记忆数据掌握在自己手中，而不是完全上传至不可控的云端。

**本项目旨在构建一个“拥有长期记忆”且“人格鲜明”的 AI 数学助教，解决移动端公式输入难题，并提供陪伴式学习体验。**

## 2. 为什么选这个 AI 工具 (Technology Selection)

本项目采用了 **Gemini API + MemOS + FastAPI** 的技术栈，选择理由如下：

### 2.1 核心大脑：Google Gemini API
* **长窗口与逻辑能力**：Gemini 在数学推演和逻辑推理方面表现优异，且支持超长上下文，适合处理复杂的学术问题。
* **角色扮演能力**：Gemini 对 System Prompt（系统提示词）的遵循度高，能够稳定维持“艾萨克·牛顿爵士”那严谨、古风且略带傲慢的人格设定。
* **响应速度**：API 响应延迟低，配合流式输出（Stream），能提供流畅的对话体验。

### 2.2 记忆中枢：MemOS (Memory OS)
* **真正的“记忆”而非“记录”**：不同于简单的向量数据库，MemOS 提供了更结构化的记忆管理。它充当了 AI 的“海马体”，允许系统存储用户的 ID、偏好及历史对话摘要。
* **RAG (检索增强生成)**：通过 MemOS 的检索接口，AI 在回答前能先“回忆”起用户是谁（例如：“这是那个上次连积分都算不对的 SamSpend”），从而生成极具个性化的开场白和回答。

### 2.3 前端技术：MathLive + KaTeX + 移动端适配
* **MathLive**：提供了专业的虚拟数学键盘，解决了 LaTeX 代码输入的门槛。
* **KaTeX**：实现了数学公式在网页端的毫秒级渲染。

## 3. 怎么做的 (Implementation Process)

系统采用 **Client-Server** 架构，分为前端交互层、后端逻辑层和数据记忆层。

### 3.1 后端架构 (Python/FastAPI)
1.  **用户鉴权系统**：使用 SQLite 构建了轻量级用户库，实现了哈希加密存储密码，确保多用户环境下记忆互不干扰（通过 UUID 映射 MemOS UserID）。
2.  **RAG 工作流**：
    * **Recall (回忆)**：在调用 LLM 前，先通过 `mem_client.search_memory` 检索当前用户的相关记忆。
    * **Think (思考)**：将检索到的记忆注入 System Prompt，构建动态的上下文环境。
    * **Store (存储)**：对话结束后，异步将高质量的交互记录写回 MemOS，形成长期记忆闭环。
3.  **流式响应**：使用 Python 生成器 (`yield`) 将 Gemini 的响应实时推送到前端，模拟真实的“打字/思考”过程。

### 3.2 前端交互 (HTML/JS/CSS)
1.  **赛博朋克 UI 设计**：采用深色玻璃拟态风格，配合霓虹光效和打字机光标动画，营造沉浸式体验。
2.  **双模输入方案 (核心突破)**：
    * 针对移动端输入痛点，放弃了纯数学编辑器方案。
    * **创新方案**：采用标准 `Textarea`（保障手机中文输入法秒弹）+ **自定义数学工具栏**（点击按钮插入 LaTeX 代码）。
    * **即时预览 (Live Preview)**：在输入框上方悬浮一个透明视窗，实时将用户输入的 LaTeX 代码渲染为数学公式，实现“所见即所得”。
3.  **视口适配**：使用 CSS `dvh` 单位和 `safe-area-inset-bottom`，完美解决了手机浏览器底栏遮挡输入框的问题。

## 4. 测试结果 (Test Results)

经过在局域网环境（Server IP: 10.21.x.x）下的多轮测试，系统达到了预期目标：

### 4.1 功能测试
* **人格稳定性**：AI 成功保持了牛顿的人设。
    * *用户*：“你好。”
    * *AI*：“（读取记忆后）SamSpend，你对矩阵行列式的求索体现了对自然法则的兴趣。吾辈期待你的进一步探究。”
* **公式渲染**：复杂的微积分公式（如 $\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}$）能被准确识别、传输并渲染，无乱码。
* **记忆检索**：用户重新登录后，AI 能准确叫出用户名字，并根据之前的对话风格调整问候语。

### 4.2 交互体验
* **移动端适配**：在 iPhone 和 Android 设备上，系统原生键盘与自定义数学键盘切换流畅，无遮挡，打字体验顺滑。
* **延迟表现**：首字生成时间 (TTFT) 控制在 1-2 秒内，打字机效果自然。

### 4.3 结论
本项目成功构建了一个**具备长期记忆、个性化人格且移动端友好的数学助教系统**。它不仅解决了数学符号输入的工程难题，更通过 MemOS 的引入，让 AI 从一个冷冰冰的问答工具变成了一个“认识你”的赛博导师。